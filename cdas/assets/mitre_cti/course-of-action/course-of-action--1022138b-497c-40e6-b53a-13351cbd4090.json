{
    "type": "bundle",
    "id": "bundle--c7242a9c-2055-4f0c-8800-c79675f44dbb",
    "spec_version": "2.0",
    "objects": [
        {
            "id": "course-of-action--1022138b-497c-40e6-b53a-13351cbd4090",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "name": "File System Permissions Weakness Mitigation",
            "description": "Use auditing tools capable of detecting file system permissions abuse opportunities on systems within an enterprise and correct them. Limit privileges of user accounts and groups so that only authorized administrators can interact with service changes and service binary target path locations. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for service file system permissions weaknesses. (Citation: Powersploit)\n\nIdentify and block potentially malicious software that may be executed through abuse of file, directory, and service permissions by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) that are capable of auditing and/or blocking unknown programs. Deny execution from user directories such as file download directories and temp directories where able. (Citation: Seclists Kanthak 7zip Installer)\n\nTurn off UAC's privilege elevation for standard users <code>[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System]</code>to automatically deny elevation requests, add: <code>\"ConsentPromptBehaviorUser\"=dword:00000000</code> (Citation: Seclists Kanthak 7zip Installer). Consider enabling installer detection for all users by adding: <code>\"EnableInstallerDetection\"=dword:00000001</code>. This will prompt for a password for installation and also log the attempt. To disable installer detection, instead add: <code>\"EnableInstallerDetection\"=dword:00000000</code>. This may prevent potential elevation of privileges through exploitation during the process of UAC detecting the installer, but will allow the installation process to continue without being logged.",
            "external_references": [
                {
                    "external_id": "T1044",
                    "url": "https://attack.mitre.org/mitigations/T1044",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://github.com/mattifestation/PowerSploit",
                    "description": "PowerSploit. (n.d.). Retrieved December 4, 2014.",
                    "source_name": "Powersploit"
                },
                {
                    "source_name": "Beechey 2010",
                    "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.",
                    "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"
                },
                {
                    "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html",
                    "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.",
                    "source_name": "Windows Commands JPCERT"
                },
                {
                    "url": "https://apps.nsa.gov/iaarchive/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm",
                    "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.",
                    "source_name": "NSA MS AppLocker"
                },
                {
                    "url": "http://seclists.org/fulldisclosure/2015/Dec/34",
                    "description": "Kanthak, S. (2015, December 8). Executable installers are vulnerable^WEVIL (case 7): 7z*.exe\tallows remote code execution with escalation of privilege. Retrieved March 10, 2017.",
                    "source_name": "Seclists Kanthak 7zip Installer"
                }
            ],
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "course-of-action",
            "modified": "2020-01-17T16:45:23.665Z",
            "created": "2018-10-17T00:14:20.652Z",
            "x_mitre_deprecated": true,
            "x_mitre_version": "1.0"
        }
    ]
}